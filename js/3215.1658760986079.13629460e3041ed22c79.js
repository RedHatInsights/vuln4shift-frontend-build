"use strict";(self.webpackChunkocp_vulnerability_frontend=self.webpackChunkocp_vulnerability_frontend||[]).push([[3215],{5862:(e,t,r)=>{r.d(t,{Z:()=>c});var n=r(4942),a=r(885),o=r(3264),i=r(3279),s=r.n(i),l=r(3237);const c=function(e){var t=e.urlParam,r=e.label,i=e.placeholder,c=e.value,u=e.apply,p=e.chipLabel,f=(0,o.useState)(),m=(0,a.Z)(f,2),d=m[0],y=m[1],v=(0,o.useState)((function(){return s()((function(e){var r;void 0!==e&&u((r={},(0,n.Z)(r,t,e),(0,n.Z)(r,"offset",0),r))}),400)})),b=(0,a.Z)(v,1)[0];(0,o.useEffect)((function(){return y(c)}),[c]);var g={type:l.Y.text,label:r,key:t,filterValues:{"aria-label":"search-field",id:"search-".concat(r.id),onChange:function(e,t){y(t),b(t)},placeholder:i,value:d}};return{filterConfig:g,activeFiltersConfig:{isShown:!!c,onDelete:function(){var e;return u((e={},(0,n.Z)(e,t,void 0),(0,n.Z)(e,"offset",0),e))},key:t,category:p,chips:[{name:c}]}}}},7903:(e,t,r)=>{r.d(t,{Z:()=>P});var n=r(885),a=r(3264),o=r.n(a),i=r(5697),s=r.n(i),l=r(2982),c=r(3193),u=r(448),p=r.n(u),f=function(e){var t=e.isLoading,r=e.columns,i=e.rows,s=e.isExpandable,u=void 0!==s&&s,f=e.emptyState,m=e.sortParam,d=e.apply,y=(0,a.useState)([]),v=(0,n.Z)(y,2),b=v[0],g=v[1],h=function(e){return b.includes(e)},w=function(e,t){if(0===i.length)return{};var r="-"===t[0]?c.SortByDirection.desc:c.SortByDirection.asc;return t=t.replace(/^(-|\+)/,"").split(",")[0],{index:e.findIndex((function(e){return e.sortParam===t})),direction:r,defaultDirection:c.SortByDirection.desc}};return t?o().createElement(p(),{colSize:r.length,rowSize:20,variant:c.TableVariant.compact}):o().createElement(c.TableComposable,{variant:c.TableVariant.compact,isStickyHeader:!0},o().createElement(c.Thead,null,o().createElement(c.Tr,null,u&&o().createElement(c.Th,null),r.map((function(e,t){return o().createElement(c.Th,{key:e.title,sort:e.sortParam&&(n=t,{sortBy:w(r,m),onSort:function(e,t,a){var o=r[n].sortParam;a===c.SortByDirection.desc&&(o="-"+o),0===i.length&&d({sort:o})},columnIndex:n})},e.title);var n})))),o().createElement(c.Tbody,null,0===i.length?o().createElement(c.Tr,null,o().createElement(c.Td,{colSpan:100},f)):i.map((function(e,t){return o().createElement(a.Fragment,{key:t},o().createElement(c.Tr,null,u&&o().createElement(c.Td,{expand:{rowIndex:t,isExpanded:h(e.key),onToggle:function(){return function(e,t){return g((function(r){var n=r.filter((function(t){return t!==e}));return t?[].concat((0,l.Z)(n),[e]):n}))}(e.key,!h(e.key))}}}),e.cells.map((function(e,t){return o().createElement(c.Td,{key:t,dataLabel:r[t].title},e)}))),u&&o().createElement(c.Tr,{isExpanded:h(e.key)},o().createElement(c.Td,{colSpan:100},o().createElement(c.ExpandableRowContent,null,e.expandableContent))))}))))};f.propTypes={isLoading:s().bool.isRequired,columns:s().arrayOf(s().shape({title:s().node.isRequired,sortParam:s().string})).isRequired,rows:s().arrayOf(s().shape({key:s().string.isRequired,cells:s().arrayOf(s().node).isRequired,expandableContent:s().node})).isRequired,isExpandable:s().bool,emptyState:s().node.isRequired,sortParam:s().string,apply:s().func};const m=f;var d=r(9085),y=function(e){var t=e.page,r=e.perPage,n=e.itemCount,a=e.apply,i=e.filterConfig,s=e.activeFiltersConfig;return o().createElement(d.Z,{pagination:{isDisabled:0===n,itemCount:n,page:t,perPage:r,ouiaId:"pagination-top",onSetPage:function(e,t,r,n){return a({limit:r,offset:n})},onPerPageSelect:function(e,t){return a({limit:t,offset:0})}},filterConfig:i,activeFiltersConfig:s})};y.propTypes={page:s().number,perPage:s().number,itemCount:s().number,apply:s().func,filterConfig:s().shape({items:s().array}),activeFiltersConfig:s().shape({filters:s().array})};const v=y;var b=r(8071),g=function(e){var t=e.page,r=e.perPage,n=e.itemCount,a=e.apply;return o().createElement(b.Pagination,{page:t,itemCount:n,perPage:r,variant:b.PaginationVariant.bottom,ouiaId:"pagination-bottom",isDisabled:0===n,onSetPage:function(e,t,r,n){return a({limit:r,offset:n})},onPerPageSelect:function(e,t){return a({limit:t,offset:0})}})};g.propTypes={page:s().number,perPage:s().number,itemCount:s().number,apply:s().func};const h=g;var w=r(5084),E=function(e){var t=e.isLoading,r=e.isExpandable,i=e.rows,s=e.columns,l=e.filters,c=void 0===l?[]:l,u=e.meta,p=e.emptyState,f=e.apply,d=u.offset,y=u.limit,b=u.total_items,g=u.sort,E=(0,w.KW)(c),P=(0,n.Z)(E,2),k=P[0],C=P[1];return o().createElement(a.Fragment,null,o().createElement(v,{page:d/y+1,perPage:y,itemCount:b,apply:f,filterConfig:k,activeFiltersConfig:C}),o().createElement(m,{isLoading:t,columns:s,rows:i,isExpandable:r,emptyState:p,sortParam:g,apply:f}),o().createElement(h,{page:d/y+1,perPage:y,itemCount:b,apply:f}))};E.propTypes={isLoading:s().bool.isRequired,columns:s().arrayOf(s().shape({title:s().node.isRequired,sortParam:s().string})).isRequired,rows:s().arrayOf(s().shape({key:s().string.isRequired,cells:s().arrayOf(s().node).isRequired,expandableContent:s().node})).isRequired,isExpandable:s().bool,emptyState:s().node.isRequired,sortParam:s().string,filters:s().array,meta:s().shape({offset:s().number,limit:s().number,total_items:s().number,sort:s().string}),apply:s().func};const P=E},8100:(e,t,r)=>{r.d(t,{wG:()=>V,Jy:()=>S,Y7:()=>L,aB:()=>R,IR:()=>x,LM:()=>Z,Wb:()=>q,P4:()=>O,ZZ:()=>T,R:()=>I,_I:()=>C,Eu:()=>_,f9:()=>k,vD:()=>w,ab:()=>E,og:()=>P});var n=r(4942),a=r(3264),o=r.n(a),i=r(6530),s=r(5240),l=r(496),c=r(9492),u=r(5697),p=r.n(u),f=r(9210),m=r(8071),d=function(e){var t=e.count,r=e.linkTo;return o().createElement("div",{className:"shield-set"},P.map((function(e){return o().createElement(m.Tooltip,{key:e.value,content:"".concat(e.label," severity")},e.hasIcon&&(0===t[e.value]?o().createElement("a",{className:"disabled-shield"},o().createElement(f.ZP,{style:{color:"var(--pf-global--disabled-color--200)"}}),o().createElement("span",null,"0")):o().createElement(i.Link,{key:e.value,to:"".concat(r,"?severity=").concat(e.value),style:{whiteSpace:"nowrap"}},o().createElement(f.ZP,{style:{color:e.iconColor}}),o().createElement("span",null,t[e.value]))))})))};d.propTypes={count:p().shape({critical:p().number,important:p().number,moderate:p().number,low:p().number}).isRequired,linkTo:p().string};const y=d;var v=r(2410),b=r(5084);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var w="vuln4shift:header-alert-dismissed",E=[{value:"all",label:"All"},{value:"last7days",label:"Last 7 days",from:(0,b.YD)(new Date,7)},{value:"last30days",label:"Last 30 days",from:(0,b.YD)(new Date,30)},{value:"last90days",label:"Last 90 days",from:(0,b.YD)(new Date,90)},{value:"lastYear",label:"Last year",from:(0,b.qc)(new Date,1)},{value:"moreThanYear",label:"More than 1 year ago",to:(0,b.qc)(new Date,1)}],P=[{value:"critical",label:"Critical",iconColor:"var(--pf-global--danger-color--100)",textColor:"var(--pf-global--danger-color--100)",hasIcon:!0},{value:"important",label:"Important",iconColor:"var(--pf-global--palette--orange-300)",textColor:"var(--pf-global--palette--orange-400)",hasIcon:!0},{value:"moderate",label:"Moderate",iconColor:"var(--pf-global--warning-color--100)",textColor:"var(--pf-global--warning-color--200)",hasIcon:!0},{value:"low",label:"Low",iconColor:"var(--pf-global--Color--200)",textColor:"var(--pf-global--default-color--300)",hasIcon:!0},{value:"none",label:"Unknown"}],k=[{value:"true",label:"1 or more"},{value:"false",label:"None"}],C=[{title:"CVE ID",sortParam:"synopsis"},{title:"Publish date",sortParam:"publish_date"},{title:"Severity",sortParam:"severity"},{title:"CVSS base score",sortParam:"cvss_score"},{title:"Clusters exposed",sortParam:"clusters_exposed"},{title:"Images exposed",sortParam:"images_exposed"}],x=[{title:"Name"},{title:"Status"},{title:"Type"},{title:"Version"},{title:"CVEs severity"},{title:"Provider"},{title:"Last seen",sortParam:"last_seen"}],O=[{title:"Name"},{title:"Status"},{title:"Type"},{title:"Version"},{title:"Provider"},{title:"Last seen",sortParam:"last_seen"}],S=[{title:"CVE ID",sortParam:"synopsis"},{title:"Publish date",sortParam:"publish_date"},{title:"Severity",sortParam:"severity"},{title:"CVSS base score",sortParam:"cvss_score"},{title:"Images exposed",sortParam:"images_exposed"}],D=function(e){return o().createElement(a.Fragment,null,o().createElement(m.TextContent,null,o().createElement(m.Text,{component:m.TextVariants.h6,style:{fontSize:14}},"CVE description")),e.description,o().createElement(i.Link,{to:"/cves/"+e.synopsis,className:"pf-u-mt-md pf-u-display-block"},"View more information about this CVE"))},_=function(e){return{key:e.synopsis,cells:[o().createElement(i.Link,{to:"/cves/"+e.synopsis,key:e.synopsis},e.synopsis),(0,s.Un)(e.publish_date),o().createElement(c.Z,{hasLabel:!0,impact:e.severity,key:e.synopsis}),(0,l.Z)(e.cvss2_score,e.cvss3_score,!0),o().createElement(i.Link,{to:"/cves/"+e.synopsis,key:e.synopsis},e.clusters_exposed),e.images_exposed],expandableContent:D(e)}},Z=function(e){return{key:e.id,cells:[o().createElement(i.Link,{to:"/clusters/"+e.id,key:e.id},e.display_name),e.status_text,e.type,e.version,o().createElement(y,{key:e.id,count:h({},e.cves_severity),linkTo:"/clusters/".concat(e.id)}),e.provider,o().createElement(v.Z,{key:e.id,date:e.last_seen,type:"relative"})]}},T=function(e){return{key:e.id,cells:[o().createElement(i.Link,{to:"/clusters/"+e.id,key:e.id},e.display_name),e.status_text,e.type,e.version,e.provider,o().createElement(v.Z,{key:e.id,date:e.last_seen,type:"relative"})]}},L=function(e){return{key:e.synopsis,cells:[o().createElement(i.Link,{to:"/cves/"+e.synopsis,key:e.synopsis},e.synopsis),(0,s.Un)(e.publish_date),o().createElement(c.Z,{hasLabel:!0,impact:e.severity,key:e.synopsis}),(0,l.Z)(e.cvss2_score,e.cvss3_score,!0),e.images_exposed],expandableContent:D(e)}},j=["limit","offset","sort"],I=[].concat(j,["search","published","severity","cvss_score","affected_clusters"]),R=[].concat(j,["search","cve_severity"]),q=[].concat(j,["search"]),V=[].concat(j,["search","published","severity","cvss_score","images_exposed"])},6743:(e,t,r)=>{r.d(t,{_:()=>f,eh:()=>b});var n=r(4942),a=r(885),o=r(3264),i=r(7563),s=r(4494),l=r(2140),c=r(8100);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var f=function(e){var t=(0,o.useState)(localStorage.getItem(e)),r=(0,a.Z)(t,2),n=r[0],i=r[1];return[n,function(t){i(t),localStorage.setItem(e,t)}]};function m(e,t){return Object.entries(e).filter((function(e){var r=(0,a.Z)(e,2),n=r[0],o=r[1];return!t.includes(n)||""===o})).forEach((function(t){var r=(0,a.Z)(t,1)[0];return delete e[r]})),e}var d=function(e){var t=new URL(window.location);return[m(i.parse(t.search),e),function(r){var n=i.stringify(m(r,e));window.history.replaceState(null,null,"".concat(t.origin).concat(t.pathname,"?").concat(n))}]},y=[function(e){var t=function(e){var t=function(e){return"".concat(1==="".concat(e).length?"0":"").concat(e)},r=new Date(e),n=r.getFullYear(),a=r.getMonth()+1,o=r.getDate();return"".concat(n,"-").concat(t(a),"-").concat(t(o))};if(e.published){var r=c.ab.find((function(t){return t.value===e.published}));e.published="".concat(r.from?t(r.from):"",",").concat(r.to?t(r.to):"")}return e}],v=["limit","offset"],b=function(e){var t=e.allowedParams,r=e.defaultParams,n=e.additionalParam,i=e.fetchAction,c=e.changeParamsAction,u=(0,s.I0)(),f=d(t),m=(0,a.Z)(f,1)[0];(0,o.useEffect)((function(){b(p(p({},r),m))}),[]),(0,l.ZP)((function(){u(i(function(e){var t=p({},e);return y.forEach((function(e){t=e(t)})),t}(m),n))}),[m]);var b=function(e){var r=d(t),n=(0,a.Z)(r,2),o=n[0],i=n[1],s=p(p({},o),e);for(var l in s)v.includes(l)&&(s[l]=Number(s[l]));i(s),u(c(s))};return b}},2110:(e,t,r)=>{r.d(t,{W9:()=>C,h:()=>P,fD:()=>k,sK:()=>E,FP:()=>h,ZH:()=>w,Ew:()=>v,zi:()=>b,ZO:()=>g,EK:()=>y});var n=r(5910),a=r(5861),o=r(4687),i=r.n(o),s=r(5564),l=r.n(s),c=function(){var e=(0,a.Z)(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l().get("/api/ocp-vulnerability/v1/cves",{params:t}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=(0,a.Z)(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l().get("/api/ocp-vulnerability/v1/clusters",{params:t}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=(0,a.Z)(i().mark((function e(t,r){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l().get("/api/ocp-vulnerability/v1/cves/".concat(r,"/exposed_clusters"),{params:t}));case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),f=function(){var e=(0,a.Z)(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l().get("/api/ocp-vulnerability/v1/cves/".concat(t)));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=(0,a.Z)(i().mark((function e(t,r){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l().get("/api/ocp-vulnerability/v1/clusters/".concat(r,"/cves"),{params:t}));case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),d=function(){var e=(0,a.Z)(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l().get("/api/ocp-vulnerability/v1/clusters/".concat(t)));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(e){return{type:n.eG,meta:{timestamp:new Date},payload:function(){return c(e)}}},v=function(e){return{type:n.A_,meta:{timestamp:new Date},payload:function(){return u(e)}}},b=function(e,t){return{type:n.UU,meta:{timestamp:new Date},payload:function(){return p(e,t)}}},g=function(e,t){return{type:n.Vh,meta:{timestamp:new Date},payload:function(){return f(e,t)}}},h=function(e,t){return{type:n.pq,meta:{timestamp:new Date},payload:function(){return m(e,t)}}},w=function(e,t){return{type:n.H1,meta:{timestamp:new Date},payload:function(){return d(e,t)}}},E=function(e){return{type:n.pj,meta:{timestamp:new Date},payload:function(){return e}}},P=function(e){return{type:n.GA,meta:{timestamp:new Date},payload:function(){return e}}},k=function(e){return{type:n.ol,meta:{timestamp:new Date},payload:function(){return e}}},C=function(e){return{type:n.r9,meta:{timestamp:new Date},payload:function(){return e}}}}}]);
//# sourceMappingURL=../sourcemaps/3215.150d6ba216586688d559a3c2bdf04de7.js.map