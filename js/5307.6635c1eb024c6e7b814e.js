(self.webpackChunkocpVulnerability=self.webpackChunkocpVulnerability||[]).push([[5307],{59698:(e,t,a)=>{"use strict";a.d(t,{Z:()=>u});var n=a(28416),r=a.n(n),i=a(45697),o=a.n(i),s=a(39467),l=a(14878),c=a(46639),p=a(89510);const m=({error:e,children:t})=>{if(!e)return t;switch(parseInt(e?.status)){case 403:return r().createElement(p.Z,{serviceName:"Vulnerability for OpenShift"});case 404:return r().createElement(s.Z,null);case 500:case 502:case 503:return r().createElement(l.Z,null);default:return r().createElement(c.Z,null)}};m.propTypes={error:o().shape({status:o().oneOfType([o().number,o().string])}),children:o().node};const u=m},55027:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var n=a(87123);const r=({urlParam:e,label:t,value:a,placeholder:r,items:i,apply:o,chipLabel:s})=>{const l=t=>{o({[e]:t.join(","),offset:0})};return{filterConfig:{label:t,type:n.Yu.checkbox,urlParam:e,key:e,filterValues:{onChange:(e,t)=>{l(t)},items:i,value:a?a.split(","):[],placeholder:r}},activeFiltersConfig:{isShown:!!a,onDelete:e=>{const t=e.map((e=>e.value)),n=a.split(",").filter((e=>!t.includes(e)));l(n)},key:e,category:s,chips:i.filter((e=>a?.split(",").includes(e.value))).map((e=>({name:e.label,value:e.value})))}}}},60395:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});var n=a(28416),r=a(23279),i=a.n(r),o=a(87123);const s=({urlParam:e,label:t,placeholder:a,value:r,apply:s,chipLabel:l})=>{const[c,p]=(0,n.useState)(),[m]=(0,n.useState)((()=>i()((t=>{s({[e]:t,offset:0})}),400)));(0,n.useEffect)((()=>p(r??"")),[r]);const u={type:o.Yu.text,label:t,key:e,filterValues:{"aria-label":"search-field",id:`text-filter-${e}`,onChange:(e,t)=>{p(t),m(t)},placeholder:a,value:c}};return{filterConfig:u,activeFiltersConfig:{isShown:!!r,onDelete:()=>s({[e]:void 0,offset:0}),key:e,category:l,chips:[{name:r}]}}}},98249:(e,t,a)=>{"use strict";a.d(t,{Z:()=>$});var n=a(28416),r=a.n(n),i=a(45697),o=a.n(i),s=a(38800),l=a(5697),c=a(51630),p=a(8128),m=a(98927),u=a(75521),d=a(64249),f=a(2613),y=a(60448),g=a.n(y),v=a(75863),b=a(75928);const h=({isLoading:e,columns:t,rows:a,isExpandable:i=!1,emptyState:o,sortParam:y,perPage:h,apply:E})=>{const[w,P]=(0,n.useState)([]),[x,S]=(0,n.useState)(!1);(0,n.useEffect)((()=>{S(a.length>0&&a.length===w.length)}),[w]),(0,n.useEffect)((()=>{x&&P(a.map((e=>e.key)))}),[a]);const C=e=>w.includes(e),D=(e,t,n)=>{if(0===a.length||!t)return{};const r="-"===t[0]?s.B.desc:s.B.asc;return t=t.replace(/^(-|\+)/,"").split(",")[0],{index:e.findIndex((e=>e.sortParam===t)),direction:r,defaultDirection:e[n]?.sortDefaultDirection??s.B.desc}};return e?r().createElement(g(),{variant:v.B.compact,rows:h||b.UZ,columns:t.map((e=>e.title)),sortBy:D(t,y)}):r().createElement(l.i,{variant:v.B.compact,isStickyHeader:!0},r().createElement(c.h,null,r().createElement(p.Tr,null,i&&a.length>0&&r().createElement(m.Th,{expand:{onToggle:()=>P(x?[]:a.map((e=>e.key))),areAllExpanded:!x},ouiaId:"expand-all"}),t.map(((e,n)=>{return r().createElement(m.Th,{key:e.title,sort:e.sortParam&&(i=n,{sortBy:D(t,y,i),onSort:(e,n,r)=>{let o=t[i].sortParam;r===s.B.desc&&(o="-"+o),a.length>0&&E({sort:o})},columnIndex:i})},e.title);var i})))),0===a.length?r().createElement(u.p,null,r().createElement(p.Tr,null,r().createElement(d.Td,{colSpan:100},o))):a.map(((e,a)=>r().createElement(u.p,{key:a,isExpanded:C(e.key)},r().createElement(p.Tr,null,i&&r().createElement(d.Td,{expand:{rowIndex:a,isExpanded:C(e.key),onToggle:()=>((e,t)=>P((a=>{const n=a.filter((t=>t!==e));return t?[...n,e]:n})))(e.key,!C(e.key))}}),e.cells.map(((e,a)=>r().createElement(d.Td,{key:a,dataLabel:t[a].title},e)))),i&&r().createElement(p.Tr,{isExpanded:C(e.key)},r().createElement(d.Td,{colSpan:100},r().createElement(f.G,null,e.expandableContent)))))))};h.propTypes={isLoading:o().bool.isRequired,columns:o().arrayOf(o().shape({title:o().node.isRequired,sortParam:o().string,sortDefaultDirection:o().oneOf([void 0,"asc","desc"])})).isRequired,rows:o().arrayOf(o().shape({key:o().string.isRequired,cells:o().arrayOf(o().node).isRequired,expandableContent:o().node})).isRequired,isExpandable:o().bool,emptyState:o().node.isRequired,sortParam:o().string,perPage:o().number,apply:o().func};const E=h;var w=a(10097),P=a(61089);const x=({isLoading:e,page:t,perPage:a,itemCount:n,apply:i,filterConfig:o,activeFiltersConfig:s,onExport:l})=>r().createElement(w.Z,{pagination:e?r().createElement(P.Skeleton,{fontSize:"xl",width:"200px",style:{margin:10}}):{isDisabled:0===n,itemCount:n,page:t,perPage:a,ouiaId:"pagination-top",onSetPage:(e,t,a,n)=>i({limit:a,offset:n}),onPerPageSelect:(e,t)=>i({limit:t,offset:0})},filterConfig:o,activeFiltersConfig:s,exportConfig:l&&{isDisabled:0===n,onSelect:(e,t)=>l(t)}});x.propTypes={isLoading:o().bool,page:o().number,perPage:o().number,itemCount:o().number,apply:o().func,filterConfig:o().shape({items:o().array}),activeFiltersConfig:o().shape({filters:o().array}),onExport:o().func};const S=x;var C=a(43185);const D=({isLoading:e,page:t,perPage:a,itemCount:n,apply:i})=>e?r().createElement("div",{className:"pf-c-pagination pf-m-bottom"},r().createElement(P.Skeleton,{fontSize:"xl",width:"350px",style:{margin:10}})):r().createElement(C.Pagination,{page:t,itemCount:n,perPage:a,variant:C.PaginationVariant.bottom,ouiaId:"pagination-bottom",isDisabled:0===n,onSetPage:(e,t,a,n)=>i({limit:a,offset:n}),onPerPageSelect:(e,t)=>i({limit:t,offset:0})});D.propTypes={isLoading:o().bool,page:o().number,perPage:o().number,itemCount:o().number,apply:o().func};const k=D;var Z=a(59698);const T=({isLoading:e,isExpandable:t,rows:a,columns:n,filterConfig:i=[],activeFiltersConfig:o=[],meta:s,error:l,emptyState:c,apply:p,onExport:m})=>{const{offset:u,limit:d,total_items:f,sort:y}=s;return r().createElement(Z.Z,{error:l},r().createElement(S,{isLoading:e,page:u/d+1,perPage:d,itemCount:f,apply:p,filterConfig:i,activeFiltersConfig:o,onExport:m}),r().createElement(E,{isLoading:e,columns:n,rows:a,isExpandable:t,emptyState:c,sortParam:y,perPage:d,apply:p}),r().createElement(k,{isLoading:e,page:u/d+1,perPage:d,itemCount:f,apply:p}))};T.propTypes={isLoading:o().bool.isRequired,columns:o().arrayOf(o().shape({title:o().node.isRequired,sortParam:o().string})).isRequired,rows:o().arrayOf(o().shape({key:o().string.isRequired,cells:o().arrayOf(o().node).isRequired,expandableContent:o().node})).isRequired,isExpandable:o().bool,emptyState:o().node.isRequired,sortParam:o().string,filterConfig:o().object,activeFiltersConfig:o().object,meta:o().shape({offset:o().number,limit:o().number,total_items:o().number,sort:o().string}),error:o().object,apply:o().func,onExport:o().func};const $=T},41533:(e,t,a)=>{"use strict";a.d(t,{V2:()=>p,Xt:()=>o,ZH:()=>u,ZO:()=>c,Zz:()=>s,l$:()=>l,mK:()=>m});var n=a(4532),r=a.n(n);const i=r().create();i.interceptors.response.use(null,(({response:e})=>{if(!r().isCancel(e)&&e?.data?.error)throw e?.data.error;return e}));const o=async e=>i.get("/api/ocp-vulnerability/v1/cves",{params:e}),s=async e=>i.get("/api/ocp-vulnerability/v1/clusters",{params:e}),l=async(e,t)=>i.get(`/api/ocp-vulnerability/v1/cves/${t}/exposed_clusters`,{params:e}),c=async e=>i.get(`/api/ocp-vulnerability/v1/cves/${e}`),p=async(e,t)=>i.get(`/api/ocp-vulnerability/v1/clusters/${t}/cves`,{params:e}),m=async(e,t)=>i.get(`/api/ocp-vulnerability/v1/clusters/${t}/exposed_images`,{params:e}),u=async e=>i.get(`/api/ocp-vulnerability/v1/clusters/${e}`)},46046:(e,t,a)=>{"use strict";a.d(t,{S:()=>y,_:()=>c,eh:()=>f});var n=a(28416),r=a(46685),i=a(65422),o=a(75928),s=a(83215),l=a(35240);const c=e=>{const[t,a]=(0,n.useState)(localStorage.getItem(e));return[t,t=>{a(t),localStorage.setItem(e,t)}]};function p(e,t){const a={...e};return Object.entries(a).filter((([e,a])=>!t.includes(e)||""===a)).forEach((([e])=>delete a[e])),a}const m=[e=>{const t=e=>{const t=e=>`${1===`${e}`.length?"0":""}${e}`,a=new Date(e),n=a.getFullYear(),r=a.getMonth()+1,i=a.getDate();return`${n}-${t(r)}-${t(i)}`};if(e.published){const a=o.ab.find((t=>t.value===e.published));e.published=`${a.from?t(a.from):""},${a.to?t(a.to):""}`}return e},e=>(e.affected_clusters&&(e.affected_clusters=o.f9.map((t=>e.affected_clusters.split(",").includes(t.value)?"true":"false")).join(",")),e),e=>(e.cluster_severity?e.cluster_severity.split(",").includes("any")&&(e.cluster_severity=void 0):e.cluster_severity="low,moderate,important,critical",e)],u=e=>{let t={...e,total_items:void 0};return m.forEach((e=>{t=e(t)})),t},d=["limit","offset"],f=({allowedParams:e,initialParams:t,additionalParam:a,fetchAction:o,changeParamsAction:s})=>{const l=(0,i.I0)(),[c,m]=(e=>[()=>{const t=new URL(window.location);return p(r.Z.parse(t.search),e)},e=>{const t=new URL(window.location),a=r.Z.stringify(e);window.history.replaceState(null,null,`${t.origin}${t.pathname}?${a}`)}])(e),[f,y]=(0,n.useState)(!0);(0,n.useEffect)((()=>{f||""!==window.location.search||g({...t})}),[window.location.search]),(0,n.useEffect)((()=>{const e=c();g({...t,...e}),y(!1)}),[]);const g=(t,n=!1)=>{const r=c();let i=n?{...t}:{...r,...t};for(const e in i)d.includes(e)&&(i[e]=Number(i[e]));l(s(i));const f=p(i,e);l(o(u(f),a)),m(f)};return g},y=({filenamePrefix:e,fetchAction:t,fetchActionParam:a,allowedParams:n})=>{const r=(0,i.I0)(),o={report:!0};return async(i,c)=>{r((0,s.wN)({variant:"info",title:"Preparing export. Once complete, your download will start automatically."}));const m=(new Date).toISOString().replace(/[T:]/g,"-").split(".")[0]+"-utc",d=p(c,n),f=await t({...u(d),...o,data_format:i},a);let y="json"===i?JSON.stringify(f.data.data):f.data.data;(0,l.Sv)(y,e+m,i),r((0,s.L1)()),r((0,s.wN)({variant:"success",title:"Downloading export"}))}}},73710:(e,t,a)=>{"use strict";a.d(t,{EK:()=>i,Ew:()=>o,QM:()=>c,ZH:()=>m,ZO:()=>l,fD:()=>f,fi:()=>p,h:()=>d,s4:()=>g,sK:()=>u,wX:()=>y,zi:()=>s});var n=a(12949),r=a(41533);const i=e=>({type:n.eG,meta:{timestamp:new Date},payload:()=>r.Xt(e)}),o=e=>({type:n.A_,meta:{timestamp:new Date},payload:()=>r.Zz(e)}),s=(e,t)=>({type:n.UU,meta:{timestamp:new Date},payload:()=>r.l$(e,t)}),l=(e,t)=>({type:n.Vh,meta:{timestamp:new Date,noNotificationOnError:!0},payload:()=>r.ZO(e,t)}),c=(e,t)=>({type:n.W3,meta:{timestamp:new Date},payload:()=>r.V2(e,t)}),p=(e,t)=>({type:n.Tc,meta:{timestamp:new Date},payload:()=>r.mK(e,t)}),m=(e,t)=>({type:n.H1,meta:{timestamp:new Date,noNotificationOnError:!0},payload:()=>r.ZH(e,t)}),u=e=>({type:n.pj,meta:{timestamp:new Date},payload:()=>e}),d=e=>({type:n.GA,meta:{timestamp:new Date},payload:()=>e}),f=e=>({type:n.ol,meta:{timestamp:new Date},payload:()=>e}),y=e=>({type:n.K7,meta:{timestamp:new Date},payload:()=>e}),g=e=>({type:n.WB,meta:{timestamp:new Date},payload:()=>e})},45467:()=>{},58392:()=>{},32857:()=>{},28992:()=>{},30187:()=>{},21626:()=>{},8572:()=>{},98379:()=>{},91993:()=>{},53336:()=>{},54994:()=>{},44690:()=>{},37494:()=>{},67761:()=>{},49854:()=>{}}]);
//# sourceMappingURL=../sourcemaps/5307.0d220304c8f63e86ea354b863e9ef3b9.js.map